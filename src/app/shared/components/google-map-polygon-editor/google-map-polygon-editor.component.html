<div class="polygon-editor-container">
  <!-- Mapa -->
  <google-map
    #map
    [center]="mapCenter()"
    [zoom]="mapZoom()"
    [options]="mapOptions"
    (mapInitialized)="onMapReady($any($event))"
    width="100%"
    height="500px"
  >
    <!-- Marcador del restaurante -->
    <map-marker
      [position]="getRestaurantMarkerPosition()"
      [options]="restaurantMarkerOptions"
    />
  </google-map>

  <!-- Panel de controles e información -->
  <div class="controls-panel">
    <div class="info-section">
      <h3>Información del Polígono</h3>
      <div class="info-grid">
        <div class="info-item">
          <span class="label">Vértices:</span>
          <span class="value">{{ vertexCount() }}</span>
        </div>
        <div class="info-item">
          <span class="label">Área:</span>
          <span class="value">{{ polygonArea() }} km²</span>
        </div>
      </div>
    </div>

    <div class="actions-section">
      @if (!isDrawing() && vertexCount() === 0) {
        <button
          type="button"
          class="p-button p-button-primary"
          (click)="startDrawing()"
        >
          <i class="pi pi-pencil"></i>
          Dibujar Polígono
        </button>
      }

      @if (isDrawing()) {
        <div class="drawing-hint">
          <i class="pi pi-info-circle"></i>
          <span>Click en el mapa para agregar vértices. Doble-click para terminar.</span>
        </div>
        <button
          type="button"
          class="p-button p-button-secondary"
          (click)="stopDrawing()"
        >
          <i class="pi pi-times"></i>
          Cancelar Dibujo
        </button>
      }

      @if (!isDrawing() && vertexCount() > 0) {
        <div class="edit-hint">
          <i class="pi pi-info-circle"></i>
          <span>Arrastra los vértices para editar el polígono</span>
        </div>
        <button
          type="button"
          class="p-button p-button-danger"
          (click)="clearPolygon()"
        >
          <i class="pi pi-trash"></i>
          Limpiar Polígono
        </button>
      }
    </div>
  </div>
</div>

<style>
  .polygon-editor-container {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .controls-panel {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding: 1rem;
    background: var(--surface-card);
    border: 1px solid var(--surface-border);
    border-radius: var(--border-radius);
  }

  .info-section h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-color);
  }

  .info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
  }

  .info-item {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .info-item .label {
    font-size: 0.875rem;
    color: var(--text-color-secondary);
  }

  .info-item .value {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--primary-color);
  }

  .actions-section {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .drawing-hint,
  .edit-hint {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem;
    background: var(--primary-50);
    border-radius: var(--border-radius);
    color: var(--primary-color);
    font-size: 0.875rem;
  }

  .drawing-hint i,
  .edit-hint i {
    font-size: 1.25rem;
  }

  button {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.25rem;
    border: none;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: all 0.2s;
  }

  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  .p-button-primary {
    background: var(--primary-color);
    color: white;
  }

  .p-button-primary:hover {
    background: var(--primary-600);
  }

  .p-button-secondary {
    background: var(--surface-200);
    color: var(--text-color);
  }

  .p-button-secondary:hover {
    background: var(--surface-300);
  }

  .p-button-danger {
    background: var(--red-500);
    color: white;
  }

  .p-button-danger:hover {
    background: var(--red-600);
  }
</style>
