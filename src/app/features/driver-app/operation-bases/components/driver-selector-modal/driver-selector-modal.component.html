<p-dialog
  [header]="'Seleccionar Drivers (' + selectionCount() + ' seleccionados)'"
  [(visible)]="visible"
  [modal]="true"
  [style]="{ width: '90vw', 'max-width': '900px' }"
  [draggable]="false"
  [resizable]="false"
>
  <div class="space-y-4">
    <!-- Barra de Búsqueda -->
    <div>
      <p-iconfield iconPosition="left" class="w-full">
        <p-inputicon class="pi pi-search" />
        <input
          pInputText
          type="text"
          placeholder="Buscar por nombre, teléfono o email..."
          class="w-full"
          [ngModel]="searchTerm()"
          (ngModelChange)="onSearchChange($event)"
        />
      </p-iconfield>
    </div>

    <!-- Tabla de Drivers -->
    <p-table
      #dt
      [value]="drivers()"
      [loading]="loading()"
      [(selection)]="selectedDrivers"
      [paginator]="true"
      [rows]="10"
      [rowsPerPageOptions]="[10, 20, 50]"
      [globalFilterFields]="['driverFullName', 'driverPhone', 'driverEmail']"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} drivers"
      styleClass="p-datatable-sm"
    >
      <ng-template pTemplate="header">
        <tr>
          <th style="width: 50px;">
            <p-tableHeaderCheckbox />
          </th>
          <th>Nombre Completo</th>
          <th style="width: 150px;">Teléfono</th>
          <th style="width: 200px;">Email</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-driver>
        <tr>
          <td>
            <p-tableCheckbox [value]="driver" />
          </td>
          <td>{{ driver.driverFullName }}</td>
          <td>{{ driver.driverPhone }}</td>
          <td>{{ driver.driverEmail }}</td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="4" class="text-center py-8">
            <i class="pi pi-inbox text-4xl text-gray-400 mb-3"></i>
            <p class="text-gray-500 dark:text-gray-400 m-0">
              No se encontraron drivers disponibles
            </p>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <ng-template pTemplate="footer">
    <div class="flex justify-end gap-2">
      <p-button
        label="Cancelar"
        severity="secondary"
        [outlined]="true"
        (onClick)="close()"
      />
      <p-button
        label="Seleccionar"
        [disabled]="!hasSelection()"
        (onClick)="confirm()"
      />
    </div>
  </ng-template>
</p-dialog>
