<p-table
  [value]="forms()"
  [tableStyle]="{ 'min-width': '60rem' }"
  styleClass="p-datatable-sm"
>
  <ng-template pTemplate="header">
    <tr>
      <th>Nombre</th>
      <th>Teléfono</th>
      <th>Email</th>
      <th>País</th>
      <th>Ciudad</th>
      <th>Fecha</th>
      <th>Estado</th>
      <th class="text-center" style="width: 4rem">Acciones</th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-form>
    <tr>
      <td>
        <span class="font-semibold">{{ form.applicantName }}</span>
      </td>
      <td>{{ form.applicantPhone }}</td>
      <td>{{ form.applicantEmail }}</td>
      <td>{{ form.countryName }}</td>
      <td>{{ form.cityName }}</td>
      <td>{{ form.requestDate | date: 'short' }}</td>
      <td>
        <app-registration-form-status-badge [status]="form.status" />
      </td>
      <td class="text-center">
        <p-button
          icon="pi pi-ellipsis-v"
          [text]="true"
          [rounded]="true"
          (onClick)="actionsMenu.toggle($event); currentFormId.set(form.id)"
        />
        <p-popover #actionsMenu>
          <div class="flex flex-col gap-1 p-2 min-w-[160px]">
            <p-button
              label="Ver detalles"
              icon="pi pi-eye"
              [text]="true"
              size="small"
              styleClass="w-full justify-start"
              (onClick)="onViewDetails(form); actionsMenu.hide()"
            />
            <p-button
              label="Aprobar"
              icon="pi pi-check"
              [text]="true"
              severity="success"
              size="small"
              styleClass="w-full justify-start"
              (onClick)="onApprove(currentFormId()); actionsMenu.hide()"
            />
            <p-button
              label="Rechazar"
              icon="pi pi-times"
              [text]="true"
              severity="danger"
              size="small"
              styleClass="w-full justify-start"
              (onClick)="onReject(currentFormId()); actionsMenu.hide()"
            />
          </div>
        </p-popover>
      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="emptymessage">
    <tr>
      <td colspan="8" class="text-center py-5">
        <i class="pi pi-inbox text-4xl text-muted mb-3"></i>
        <p class="text-muted">No se encontraron formularios</p>
      </td>
    </tr>
  </ng-template>
</p-table>
