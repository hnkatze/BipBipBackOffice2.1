<!-- Drawer -->
<p-drawer
  [visible]="true"
  position="right"
  styleClass="!w-full md:!w-[600px]"
  (onHide)="handleClose()"
  [header]="isEditMode() ? 'Editar Punto de Emisión' : 'Crear Punto de Emisión'"
>
  <!-- Toast -->
  <p-toast />

  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-6">
    <!-- Nombre del punto de emisión -->
    <div>
      <label for="emissionPointName" class="block text-sm font-medium mb-2">
        Nombre punto de emisión <span class="text-red-500">*</span>
      </label>
      <input
        pInputText
        id="emissionPointName"
        formControlName="emissionPointName"
        placeholder="Escribe el nombre del punto de emisión"
        class="w-full"
        [class.border-red-500]="isFieldInvalid('emissionPointName')"
      />
      @if (isFieldInvalid('emissionPointName')) {
        <small class="text-red-500">
          {{ getFieldError('emissionPointName') }}
        </small>
      }
    </div>

    <!-- Número del punto de emisión -->
    <div>
      <label for="emissionPointNumb" class="block text-sm font-medium mb-2">
        Número de punto de emisión <span class="text-red-500">*</span>
      </label>
      <input
        pInputText
        id="emissionPointNumb"
        formControlName="emissionPointNumb"
        placeholder="Escribe el número"
        class="w-full"
        [class.border-red-500]="isFieldInvalid('emissionPointNumb')"
      />
      @if (isFieldInvalid('emissionPointNumb')) {
        <small class="text-red-500">
          {{ getFieldError('emissionPointNumb') }}
        </small>
      }
    </div>

    <!-- Dirección -->
    <div>
      <label for="emissionPointAddress" class="block text-sm font-medium mb-2">
        Dirección <span class="text-red-500">*</span>
      </label>
      <input
        pInputText
        id="emissionPointAddress"
        formControlName="emissionPointAddress"
        placeholder="Escribe la dirección"
        class="w-full"
        [class.border-red-500]="isFieldInvalid('emissionPointAddress')"
      />
      @if (isFieldInvalid('emissionPointAddress')) {
        <small class="text-red-500">
          {{ getFieldError('emissionPointAddress') }}
        </small>
      }
    </div>

    <!-- Estado -->
    <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
      <label class="text-sm font-medium text-gray-700 dark:text-gray-300">
        Estado
      </label>
      <div class="flex items-center gap-2">
        <span class="text-sm text-gray-600 dark:text-gray-400">
          {{ form.get('emissionPointEnabled')?.value ? 'Activo' : 'Inactivo' }}
        </span>
        <p-toggleSwitch formControlName="emissionPointEnabled" />
      </div>
    </div>

    <!-- Footer buttons -->
    <div class="flex flex-col-reverse sm:flex-row gap-3 pt-6 border-t border-gray-200 dark:border-gray-700">
      <!-- Botón Cancelar -->
      <p-button
        type="button"
        label="Cancelar"
        severity="secondary"
        [outlined]="true"
        (onClick)="handleClose()"
        [disabled]="isLoading()"
        styleClass="w-full sm:w-auto"
      />

      <!-- Botón Guardar -->
      <p-button
        type="submit"
        [label]="isLoading() ? 'Guardando...' : (isEditMode() ? 'Guardar Cambios' : 'Guardar')"
        [loading]="isLoading()"
        [disabled]="isLoading()"
        styleClass="w-full sm:w-auto"
      />
    </div>
  </form>
</p-drawer>
